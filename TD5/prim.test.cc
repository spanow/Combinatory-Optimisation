#include "prim.h"
#include "main_utils.h"
#include "graph_utils.h"
#include <algorithm>
#include <string>
#include <sstream>
#include <vector>
using namespace std;

int main() {
  {
    cout << "Simple examples." << endl;

    CHECK_EQ(Prim(3, {{0, 1, 3}, {1, 2, 4}, {2, 0, 5}}), 7);
    cout << "PASSED at line " << __LINE__ << endl;

    CHECK_EQ(Prim(4, {{0, 1, 23}, {1, 3, 13}, {2, 1, 6}, {3, 2, 11}, {0, 2, 41}}), 40);
    cout << "PASSED at line " << __LINE__ << endl;

    CHECK_EQ(Prim(5, {{1, 2, 1}, {2, 3, 2}, {3, 4, 3}, {4, 0, 4}, {0, 1, 5},
                      {3, 0, 1}, {4, 1, 2}, {0, 2, 3}, {1, 3, 4}, {2, 4, 5}}),
             6);
    cout << "PASSED at line " << __LINE__ << endl;
  }
  {
    cout << "Corner cases." << endl;

    // Just one node, no edge.
    CHECK_EQ(Prim(1, {}), 0);
    cout << "PASSED at line " << __LINE__ << endl;

    // Zero node
    CHECK_EQ(Prim(0, {}), 0);
    cout << "PASSED at line " << __LINE__ << endl;

    // Zero weights.
    CHECK_EQ(Prim(10, {{1, 2, 0}, {2, 3, 0}, {3, 4, 0}, {4, 5, 0}, {5, 6, 0},
                       {6, 7, 0}, {7, 8, 0}, {8, 9, 0}, {9, 0, 0}, {0, 1, 0},
                       {1, 6, 0}, {2, 7, 0}, {3, 8, 0}, {4, 9, 0}, {5, 0, 0}}),
             0);
    cout << "PASSED at line " << __LINE__ << endl;
  }

  const int trials = 1000;
  /*const int expected[2][1000] = {
    {31825,70462,31682,10672,94911,12038,23165,158009,3022,3925,3548,6166,21543,1109,27743,11982,196141,186897,15775,20992,49593,141847,80388,14196,5356,13781,50715,11812,112246,5044,40061,828121,33294,5967,12195,140064,55077,57065,2659,109147,10444,9089,151781,32485,147449,52347,92342,7948,4122,25875,53965,28727,48496,131717,14629,3320,9614,242901,11681,279077,13029,56764,135532,808663,7738,3824,95865,130306,162203,197165,220688,5209,1437,46107,3177,1015,17726,678609,127247,124307,24678,123721,180842,35537,2980,3205,10253,5087,117173,39049,442588,3594,22387,77584,69702,2488,78496,341297,192412,17129,4636,63581,115101,1028,2917,2074,3119,13370,53085,3657,6664,18287,187012,123743,1082,49933,38812,10372,22183,77607,5715,1131,87326,11633,3127,28079,39795,7670,4914,251070,3054,1166,17275,118443,3486,946995,23950,175569,993,2271,92097,49804,59634,7776,3555,44481,67237,1450,8310,673682,9236,6801,211515,71291,10550,203964,30952,85481,368721,3867,230397,77818,420007,142834,32223,19119,13753,6146,118424,1327,244214,66406,7725,17651,41712,51403,289,707555,32568,125801,23778,16472,15786,1288,3331,60940,16020,98272,15595,67724,693,148668,40140,9432,38428,17591,232859,125913,195950,1566,5643,53485,141705,152248,138909,186637,6171,98528,483239,26999,24194,14433,237634,6463,1428,419641,10994,84526,8372,121364,119314,30129,40409,21067,74256,22547,146275,76498,369,1623,2223,58226,1267,51492,912220,115952,1268950,13898,27322,122737,21748,67496,312755,67987,22752,6857,129464,54507,10617,691713,25701,8600,142744,171264,2631,24449,176788,356,12522,85216,543213,6016,13341,73540,9482,5632,47637,36859,9969,194302,93626,232205,26168,31505,651,3212,14898,2070,94681,457423,64923,4555,38863,45290,2163,14162,108767,15384,194376,103275,28706,21244,27212,379979,1319,550,21840,2794,113498,31838,13920,267439,6226,35865,139822,5669,81317,2035,65611,6113,654417,1106,16717,8760,23596,24126,462475,53313,27716,948,1422,10052,3770,1336,56878,240849,12381,22564,17721,816,11916,4412,45709,43678,372053,22344,5627,157179,64544,424614,18784,43056,20095,9816,933,211011,6384,5208,48476,65100,279279,314387,157019,7491,33441,21152,15511,136334,54842,50626,132674,645794,6567,45354,366643,6293,20400,54016,8779,8791,33371,466910,33738,34162,2416,51868,198820,8239,145553,441725,776,69937,103158,29886,69925,322735,34891,13290,83528,31333,624811,23277,4559,3809,56310,293446,12423,11227,101188,595354,10999,293497,306296,15747,89389,25691,7992,47638,61096,43819,112275,28550,59843,4193,8372,364788,130621,5431,18288,28446,14084,187348,74968,45066,181135,186455,38788,1328,97626,699815,3263,67252,20918,26477,52664,13378,8326,2649,4668,257178,3290,188417,91575,12418,213637,52699,2901,13209,93678,480987,4778,29326,1101,108688,15513,802,20629,8942,126838,430910,348887,98306,1537,89410,6137,1942,26953,4360,14153,5224,5975,19688,12190,96488,1875,46983,1079071,262162,15703,123959,29028,494520,16817,14097,7326,3842,28750,16161,162042,20351,308651,28773,17669,21273,6038,110831,241330,126219,561936,28995,17086,95471,5738,11677,3749,269642,1860,10211,85054,89515,184073,26733,40066,64411,1483,112718,769,421147,12982,10895,923,43384,26027,144554,210760,37829,725,57704,10549,87635,521391,16208,17605,9929,24692,1903,167011,55188,12615,284741,133717,36672,7996,98991,180457,25635,88155,82332,128094,9436,8085,36712,53407,274283,131553,22471,28839,2684,78645,67209,49625,59118,1325682,370827,14592,851,564857,8025,75557,170318,43436,72372,8790,27132,79933,74288,71899,29890,3891,59447,832,3986,36321,19260,10637,27246,1435,1020961,23998,165533,1012,964301,17692,66854,22581,14251,1789,3037,20426,209819,32647,16849,4001,12703,76628,7532,92887,253161,88836,1149,93833,77541,26689,37293,61890,1341,408069,134430,4105,1053,10762,160091,1825,77487,505061,37129,19541,226005,464496,607390,37741,2587,62182,86989,267591,22021,187457,253573,14990,940,503811,17643,68305,88741,2115,346524,1486,141235,74340,57958,18867,141692,33301,51355,485578,500735,21085,418346,111219,4871,7850,1639,1325,36533,3732,49335,118954,36104,979,231933,119652,1494,30810,31871,1614124,3821,6482,1829,65853,976,5172,17197,19943,297470,1481,631225,11731,683282,8439,9868,9316,341167,27753,5001,6566,158436,38493,170954,1838,33104,216692,11601,39534,7636,19886,61070,670837,5772,14686,997,261793,125139,17382,1127,98546,435812,20760,2609,5303,24361,16948,10473,31275,69240,91822,427678,83438,407515,5031,18177,609529,350204,33404,39522,4478,6356,715533,64228,2753,63732,728,97881,819,1684,8881,5565,336201,3218,56995,223092,41681,104837,11652,238227,163271,60454,3080,731,1024,170749,17337,95208,5054,28449,643,85570,106251,1066912,82088,8301,370855,177468,15322,4357,41583,20060,46184,177843,9243,1325,11641,157180,48810,1839,11671,15468,5213,329136,4033,4528,54814,6051,25407,233681,160442,225128,705964,12629,190223,157402,10872,928,317819,8160,164506,307273,75789,631,471868,312412,12253,718681,111980,9147,110728,2549,177847,2858,10086,105720,24969,1092,58526,12822,80855,86180,490021,29063,22738,585166,34320,210314,44611,1347,667694,86569,25153,90827,15191,19802,4777,82422,87450,96388,29516,1165325,83608,13156,14263,28238,70482,381610,50323,75110,3138,190347,2528,9205,6233,80352,80774,1115,15720,13578,27844,35688,139873,44092,44835,24769,29870,372233,321976,1254,21445,19469,115179,9566,3442,3285,17303,41969,64208,36648,371142,5741,87484,264432,22946,6396,1014,20091,10381,7886,9065,51039,17874,250559,10706,43347,4074,8683,64267,34798,93407,15236,29726,28813,51620,5923,190727,22388,786,863,199076,18961,162406,74111,224417,24174,65245,199169,1531,1030,11272,2848,1699,10058,533169,48970,19354,13606,99121,668876,92625,21721,264389,8656,121188,51881,91526,4941,32395,178204,489331,16021,390700,47861,560566,10742,48027,224753,14062,245790,5108,31339,9784,7681,166317,49430,65307,14137,4634,10244,246116,623,16429,4533,24007,48714,2694,18095,10556,17020,48500,112945,58318,88414,14257,2081,1525,5393,1558,52358,112665,23655,204890,428564,84078,212944,562112,503278,19758,26379,1278,266589,96807,34029,28970,40689},
    {30880,687464,23105,244803,29654,14508,33343,327567,5708,3236,3810,132758,8564,6644,102468,143949,5038,32466,76855,50416,3577,12960,2061,19779,264903,5730,6504,24252,28810,147650,11155,72342,31685,1569,132380,16081,200765,23719,14342,24767,455366,284998,4348,315859,391314,2214,49503,11207,7584,218688,188775,36440,614036,15512,7034,22310,2213,511043,65617,275500,10807,54713,59230,19842,180245,122770,3295,1643,1092,6869,72349,321656,139986,363910,1293,7657,9530,60870,83094,132088,35162,61002,20453,14756,65092,12200,436862,1342,416717,119039,949,16619,23629,12509,9640,167449,76653,175401,26302,36111,100177,57534,29682,12774,151388,1199,3099,36886,632252,578176,7224,111326,15457,95808,23659,5682,1553,158914,144559,121294,34012,42727,17440,1748,26739,22841,23133,317557,79124,7555,70967,29902,1200,21328,2564,6782,690944,87523,1893,7809,6258,22955,40328,38624,131283,35491,19926,127433,1267,53732,2291,13500,69581,617,32467,7032,82998,165786,9708,22853,54810,4639,28306,238226,17142,1788,26251,51843,19268,39687,13656,7055,1674,5564,13233,26026,17078,7662,13805,6280,204000,161356,350201,9027,33033,176085,4459,1188,1874,66218,12169,85515,26710,47614,52044,21061,1593895,9909,196944,268999,42819,8215,62842,48018,801,116004,15509,26929,1532,10227,14425,98249,188277,522452,60762,63819,288909,2595,68224,2097,33897,94121,5904,48713,73001,7015,38690,50025,192352,28291,16541,77310,120518,756907,61312,92954,92750,122761,9959,19878,45916,226997,142758,193527,297009,1531,243303,48318,11256,19062,2088,28637,120010,208892,3380,7366,122394,12176,131079,58530,13759,173539,4062,171497,30715,14730,669777,6690,216303,62556,162606,141068,1330,128862,4610,91273,24034,15575,58251,43960,2064,4778,1763,189135,212705,11305,34489,1129809,23609,84608,1384151,274522,22197,287356,122105,3872,19010,119278,43786,1296175,9763,20934,2843,338998,1755,10129,57811,58384,238867,5232,13742,245194,158666,17685,12493,5786,133461,83860,1328,74670,178238,27168,230477,3040,809959,316943,15195,882215,513,16453,13765,161328,3914,157449,41065,9527,9346,1971,24358,127372,4389,32997,1471,119809,87812,1204,34465,23380,17491,36729,8518,411789,5047,8106,115517,19831,29332,8034,86565,61971,153374,52221,36420,31265,220754,43505,3057,28399,1117,173553,576856,79590,75318,13046,2988,211711,130620,12655,246587,84519,2062,119337,7724,19382,4059,219701,2930,109196,5028,1550,1776,2459,19948,235691,12206,31910,3814,36811,35678,15499,656228,56931,1385,901,94199,13242,5381,5889,3012,503392,124123,155493,7015,18801,48290,161290,16928,2875,1383,297111,9924,619917,17212,83670,775886,215253,166315,18938,417686,84008,8064,28068,23159,107763,14362,33929,9083,25357,97836,2046,1873,48607,19188,100941,40724,59214,34327,40540,14266,52035,13551,1449,213230,5913,21672,350485,12690,1335,671946,21125,2828,168246,66431,2388,6467,12030,1136,42205,694033,1498,242250,962206,129517,130324,9391,1289,70415,487968,20568,1962,57747,694,4034,10241,210598,18851,1669,13162,39565,7049,1686,137510,95375,44061,5472,65734,194492,39389,6065,20143,151658,9418,23904,25148,583727,372305,116967,167547,188117,380435,205417,568442,272545,134284,23363,17218,35760,1435,164499,1565,27552,9006,781036,10311,5616,9614,57619,184130,8036,10757,24866,64900,26021,1709,49314,1481,30213,519780,3788,17348,37846,112,227139,164795,425521,1883,111249,1909,1448,114896,6381,60927,17883,1240,41238,26593,30778,248236,409435,76214,3015,1688,21440,23911,1386,56024,240542,13345,368568,2049,2085,5351,7243,894,14102,21170,33760,8074,15168,1629,255823,1151,55255,5292,114553,388878,161086,21554,156149,29374,45705,161809,22804,77371,12562,59769,16587,15428,87391,52795,50947,139975,19664,5685,80019,62407,8366,29568,619843,7544,11203,24949,30526,29310,337011,17157,6843,10657,73155,3138,18285,304146,24548,4201,1099,98907,30609,1469,80215,2221,975,73466,195874,170827,166259,36409,29739,45373,106367,24768,111695,84785,18117,192373,59074,26992,9192,114476,1404,5013,331794,74731,10469,1568,526221,3755,7986,34587,951429,99749,35089,51684,943,17734,329719,29020,2010,60670,6718,1149622,1906,520858,123413,49319,18866,17888,171356,295359,215217,7540,385426,30976,777361,12106,74358,2034,26081,266005,21645,8429,2291,78261,14459,112215,12026,120405,57014,1943,17355,19224,2859,17392,2222,189275,93414,1262603,3575,497265,22772,25899,7962,224382,28110,249899,4298,2041,41761,9136,5152,1636706,225611,154007,81165,208593,68217,10717,2762,2915,47945,181903,1656,76688,93865,10310,93048,18996,290073,46437,3231,44144,1096,31712,20152,4761,19964,2760,287941,2667,625594,181429,25179,243473,176611,7214,6203,136613,23571,326160,324915,355670,15331,11497,8166,86240,109122,58228,20803,324801,13154,1809,88869,43206,1658,22216,146401,81895,81771,137490,23952,30153,16840,60340,4624,13924,8295,278870,3128,121174,11972,120595,1741,38220,6957,60350,19713,74621,19640,615851,141717,12994,70225,28421,470159,380604,11721,25169,32979,6403,55456,11747,1361,23020,275186,5441,32452,236634,420724,14580,3190,31336,82728,7643,186181,4979,281613,1238122,11281,346486,4620,212359,67909,20471,87149,20751,60476,8644,60171,134996,3497,31935,246116,53796,13401,98983,647386,69555,298945,24791,57637,12353,9672,22730,46241,171888,1113,42971,10362,1622,14181,158145,6354,4375,54905,437976,14599,152649,109744,10200,2934,41451,13253,158841,88641,155005,2796,4210,477212,156523,197863,25589,3642,278234,1141,2534,10126,136383,10734,8899,52302,6982,43088,3808,266249,994,342223,8952,2270,605629,2612,19442,72453,6225,13325,25427,9878,192825,4934,38413,12323,32295,2641,2177,37453,1141,13008,1260,92846,4603,19249,77121,53613,28758,2515,7133,84682,25668,393892,59871,7539,6658,131414,69037,269995,49195,227759,3196,80416,7459,43282,237048,19053,19684,7271,6136,183247,3328,19083,45762,85055,295949,29854,405273,9239,9065,23323,135495,185868,59105,30828,11134,2621,304315,1776,139094,2367,460045,34138,22701,310345,3074,294061,9376,1685,16223,9612,10504,1670,7037,58065,173673,1658,2403,39833,1226,17137,50162,5627,56733,21688,726623,38728,1524,161902,212275,8922,84000,279191,16393,501141,36224},
  };*/
  const int expected[2][1000] = {
  {31825, 284792, 8128, 74173, 69269, 21373, 83438, 31951, 28812, 247703, 160935, 51072, 2763, 80646, 34796, 48397, 133797, 1070, 144647, 324872, 52749, 148228, 155422, 268609, 254819, 6801, 87053, 32803, 33942, 6844, 1339, 535991, 9531, 57407, 17471, 341687, 20260, 7621, 8827, 341677, 4029, 25846, 168588, 51134, 12992, 52712, 253501, 22681, 88332, 52433, 3158, 58628, 203589, 51942, 4546, 2527, 1744, 367499, 106336, 7141, 216319, 38509, 18881, 195105, 2004, 22842, 114593, 19760, 93486, 406153, 12221, 186598, 15530, 578930, 87507, 119457, 49341, 72072, 4394, 274608, 28420, 9031, 12622, 1280, 765107, 5447, 26486, 20527, 57069, 106333, 66500, 51187, 1879, 2120, 22398, 93457, 70293, 7214, 19679, 842, 1420, 52613, 444737, 503472, 35311, 13669, 80842, 42830, 57791, 41847, 161143, 93066, 588603, 75161, 121000, 49392, 65122, 2698, 95716, 34796, 26145, 126930, 172905, 41752, 81821, 19433, 19073, 127272, 51925, 407053, 51238, 165379, 2670, 13654, 135231, 45258, 722, 134587, 124434, 49424, 96828, 111984, 28567, 34600, 54735, 150225, 13100, 251643, 167572, 29788, 9635, 19707, 1402, 2061, 58103, 130229, 108945, 28819, 30316, 18026, 1191, 70490, 7804, 53113, 68620, 24407, 460204, 1206, 74730, 11270, 2768, 16028, 30806, 6853, 859, 439779, 18118, 15475, 38535, 2982, 2628, 24845, 24357, 527433, 4505, 3365, 97888, 46080, 843105, 29619, 81154, 7658, 5917, 189871, 46410, 3205, 12888, 6620, 2098, 57130, 5020, 3984, 62084, 14894, 25723, 85627, 438715, 244719, 213367, 170722, 153604, 2288, 635675, 154386, 85339, 89297, 189374, 436716, 15733, 4049, 33514, 56703, 17078, 29565, 34790, 6298, 448306, 46111, 23591, 54632, 2512, 119471, 202437, 12735, 49192, 312440, 5279, 25861, 37703, 25668, 2226, 23675, 176265, 88885, 11331, 332937, 13172, 43408, 3107, 10612, 478544, 263647, 91392, 11148, 63267, 35618, 2644, 8876, 46520, 56436, 118491, 65481, 23192, 164884, 1082, 116652, 23212, 261245, 3087, 277179, 300111, 39506, 14766, 88404, 82485, 1721, 627514, 40986, 10392, 113170, 12407, 119327, 247679, 163543, 2167, 973, 730408, 123468, 23750, 78162, 23314, 8460, 244095, 4165, 112253, 2588, 1151, 246905, 31767, 326168, 61186, 4592, 14560, 20727, 291494, 73631, 23510, 33304, 15138, 332676, 218001, 83723, 12600, 1279, 14602, 73618, 34848, 193777, 253166, 198553, 75882, 67442, 2261, 1177, 30404, 428449, 207466, 95381, 166956, 2884, 21129, 530, 13217, 6851, 150289, 19293, 7960, 616673, 34271, 40458, 34759, 23635, 255828, 8441, 23120, 7570, 10408, 5657, 12238, 46821, 43400, 328146, 93771, 77466, 2140, 766050, 423917, 310774, 47534, 68037, 19573, 23352, 911, 383022, 191818, 12567, 21249, 17189, 1541, 10431, 40534, 111460, 4700, 60877, 102320, 66956, 44619, 181146, 3640, 7621, 6768, 818, 467642, 288618, 13940, 62054, 343215, 7542, 991, 7672, 4568, 55188, 146384, 4247, 5388, 106480, 101367, 1453, 204039, 78496, 57617, 14386, 50116, 1108, 58237, 19626, 18732, 1143, 191741, 979105, 6980, 31595, 95689, 75386, 7671, 102408, 1104612, 250785, 59442, 182696, 44624, 382682, 43408, 12681, 53020, 167349, 1705, 23507, 60304, 8194, 31467, 19028, 26024, 113655, 159609, 135886, 8258, 6908, 5847, 179936, 4648, 33083, 746556, 691864, 215482, 41326, 82218, 10750, 17974, 40769, 13172, 1010, 137749, 2222, 3812, 46119, 112299, 117679, 678937, 45302, 9994, 3560, 1005409, 25890, 22708, 47132, 9812, 362387, 77780, 72248, 10499, 52951, 115627, 20801, 11583, 227830, 19568, 210036, 4320, 13148, 44297, 85181, 122634, 46272, 49830, 11350, 61275, 14217, 8237, 165855, 2815, 149205, 213995, 76465, 545953, 26687, 20244, 27762, 8256, 22148, 39815, 311410, 32188, 20163, 29104, 83912, 2080, 67426, 252377, 129882, 1868, 13152, 80695, 123276, 47632, 775, 224722, 6501, 948, 2828, 313238, 960500, 1010, 19480, 312002, 631665, 24219, 9785, 30950, 105233, 29190, 124771, 35714, 127978, 19006, 1616, 36673, 255064, 2396, 22911, 6464, 6298, 24568, 28037, 163886, 211559, 23622, 173750, 19227, 177189, 3780, 17110, 16358, 131610, 132468, 5318, 6811, 12103, 54865, 2236242, 120171, 33624, 38459, 141967, 3717, 1124, 49180, 49656, 41590, 1936, 139211, 104986, 11775, 2539, 113519, 1000, 63084, 56882, 1287, 3751, 1328, 2988, 140840, 116786, 83333, 197957, 232942, 99680, 25905, 113324, 135041, 270584, 63884, 5418, 29743, 9947, 105676, 80749, 23263, 46787, 537710, 1147, 17590, 5838, 13252, 28891, 118002, 178, 5941, 236107, 8992, 69473, 1701, 152001, 4830, 24691, 57045, 96224, 6589, 66008, 79000, 77362, 800, 4603, 56588, 386566, 89150, 79371, 62940, 120486, 72251, 12768, 1211, 18715, 7995, 1630081, 9296, 24782, 138026, 230390, 528531, 50407, 56181, 10642, 16734, 27702, 30234, 260349, 58458, 196806, 56436, 38866, 69773, 5459, 1639, 7137, 134168, 335024, 2278, 135189, 2815, 119167, 4445, 1798, 813939, 49073, 64771, 13728, 125158, 378184, 163180, 158223, 204238, 32298, 4678, 104778, 1776, 217598, 107383, 22616, 12002, 335867, 39838, 41470, 672444, 65892, 23528, 87190, 49257, 41475, 74181, 1638, 465607, 3453, 5034, 236117, 667, 8041, 6446, 76928, 76328, 181035, 53674, 225270, 6900, 1408, 17042, 1172, 1944, 262998, 4391, 95950, 33296, 12948, 20751, 10225, 33457, 262522, 120012, 67351, 40552, 26848, 62403, 1920, 20009, 62124, 22976, 90951, 899192, 128666, 7369, 37936, 17621, 317900, 5647, 64264, 1800, 22445, 1461, 25296, 47843, 92955, 21938, 39330, 73203, 640833, 54205, 129712, 1524, 17046, 10287, 28966, 28481, 6894, 5987, 190600, 755474, 4675, 23185, 5477, 2923, 200180, 7308, 58312, 244283, 101821, 2928, 192293, 68663, 45978, 879, 486669, 7084, 2743, 26357, 14809, 34374, 195748, 5411, 72032, 32857, 325683, 107707, 63646, 232030, 105369, 5667, 44532, 15590, 40882, 328272, 2218, 37760, 26386, 44584, 44993, 27269, 860, 82671, 95538, 17546, 45759, 38040, 102601, 75871, 24859, 8541, 17749, 40619, 88962, 270920, 82372, 21567, 37235, 64224, 27714, 2436, 19450, 46695, 9935, 839, 4468, 10697, 45866, 367877, 67362, 82507, 10446, 2127, 1426, 6929, 290861, 97118, 55821, 1254056, 53810, 32385, 405190, 298439, 2113, 43491, 1228, 3991, 50940, 29182, 14896, 5115, 357237, 4025, 8428, 2740, 45199, 7408, 15558, 5354, 94813, 20944, 22282, 1288, 18686, 211582, 814, 31963, 607303, 50601, 14841, 29309, 790, 3862, 4692, 18938, 44739, 113858, 2427, 39314, 22047, 36267, 15769, 1485, 7833, 23299, 564, 56918, 60665, 11683, 58757, 1560, 606, 21412, 19587, 4170, 33845, 26714, 6004, 363732, 97597, 10702, 1833, 17481, 26218, 9041, 14866, 46658, 183826, 24742, 9791, 12388, 8113, 13155, 1069, 51757, 204970, 16290, 25884, 151257, 34560, 14397, 196325, 10958, 11148, 254867, 79144, 58247, 5209, 29322, 36105, 1340, 72042, 4788, 61350, 13055, 15077, 18856, 10235, 23213, 164422, 463262, 7405, 124917, 209593, 48787, 98660, 89375, 9684, 877, 195372, 86522, 511469, 818, 7242, 148870, 3818, 349161, 98654, 46383, 49322, 127913, 7146, 167374, 102526, 36459, 39916, 31142, 4293, 5321, 26040, 22683, 85867, 2378, 299, 248698, 1500, 62921, 62137, 198453, 150466, 697690, 946886, 90601, 16137, 38100, 3894, 25554, 5541, 10360, 17198, 726, 8678, 43266, 69637, 321463, 60055, 422614, 59620, 9911, 9902, 55484, 322456, 252983, 499506},
  
  {30880, 264755, 3869, 9186, 182087, 244803, 56921, 22987, 218960, 43010, 21109, 507982, 16236, 580399, 3312, 1323, 162052, 2088, 1345646, 55768, 60471, 16216, 38147, 9261, 18741, 62356, 57364, 19274, 305781, 48800, 30480, 4288, 11852, 4054, 67631, 2349, 2077, 98478, 19321, 8324, 28977, 257542, 5511, 3386, 400605, 104030, 20696, 718336, 16194, 71961, 79961, 427404, 58162, 97774, 26559, 31883, 1152, 7444, 0, 78423, 790, 57073, 1159, 35302, 41403, 71062, 772745, 7047, 18549, 14917, 560460, 2561, 43866, 5259, 25510, 87569, 11642, 281272, 10584, 18304, 19824, 78278, 10350, 18557, 64524, 8107, 32772, 44588, 244805, 63273, 38318, 205350, 523765, 77405, 5121, 9028, 2415, 1511, 42103, 1248, 12791, 14573, 5819, 68883, 37781, 1670, 654298, 930, 17468, 36681, 96783, 84340, 93651, 117391, 7076, 232020, 7241, 11742, 54730, 5066, 1827, 118787, 81527, 1713, 495510, 1640, 153981, 9710, 38786, 80700, 153778, 50893, 56815, 77859, 20707, 1525, 29138, 12452, 65585, 41867, 724673, 58141, 98806, 320964, 1294, 2586, 8724, 1352, 27002, 1066532, 78921, 126599, 29795, 9541, 11310, 28948, 1662, 20329, 113736, 120851, 19874, 6207, 75841, 17353, 12955, 27613, 328212, 458467, 5707, 22493, 35197, 40044, 115670, 4178, 163575, 303774, 22588, 173709, 30061, 379653, 34058, 46062, 174786, 232336, 138540, 976327, 29813, 107850, 232464, 26473, 14069, 879811, 47336, 1646, 5065, 21956, 745786, 109128, 60559, 15320, 109512, 10635, 22627, 423597, 21005, 9486, 221055, 207990, 70369, 6577, 124340, 6800, 1910, 329766, 13562, 1052, 11439, 183, 4247, 41123, 6212, 89167, 199820, 19638, 1956, 32505, 1261, 31715, 1648, 1667, 138862, 9701, 103150, 55641, 13795, 231464, 147814, 129179, 813, 2513, 21590, 268382, 7193, 84925, 139853, 12689, 96732, 662486, 1969952, 110323, 11872, 31267, 145886, 19138, 3479, 11986, 116337, 10901, 544252, 1131, 22559, 1284496, 36907, 37388, 67463, 11868, 24662, 8931, 40830, 224259, 12987, 1403, 26010, 113391, 84767, 48435, 8740, 9482, 21001, 99881, 6338, 29099, 1512, 164554, 73258, 24657, 80810, 1207, 306190, 1501, 5474, 376744, 47022, 29353, 6244, 150294, 53755, 100338, 278872, 7706, 29039, 76264, 2017, 9209, 112566, 68074, 9592, 23385, 87020, 24879, 104276, 135173, 11206, 10748, 3897, 265080, 778444, 18686, 6548, 61223, 16502, 102909, 72326, 42603, 29935, 97383, 51115, 31189, 64915, 291540, 7309, 20581, 1802, 18051, 283210, 5340, 294488, 362047, 72063, 1270, 1104, 1143, 50918, 133691, 89638, 216745, 5266, 1290, 9232, 14574, 68504, 72190, 9371, 831542, 102300, 72028, 11973, 67619, 465367, 24237, 112568, 93069, 639575, 14129, 4069, 12631, 3485, 125962, 7797, 76168, 1091, 36294, 36829, 13943, 39330, 7852, 1148, 74177, 583, 664333, 2764, 78126, 19029, 35110, 83461, 198911, 703346, 285580, 1300, 21552, 35408, 3869, 29263, 148078, 21603, 841097, 834493, 10156, 153859, 18859, 3540, 27242, 21025, 3086, 72244, 28971, 64002, 67674, 659616, 159098, 171552, 6991, 7944, 8454, 1900, 18361, 1152, 16890, 67430, 100366, 105874, 17938, 33939, 10277, 6359, 455952, 42027, 42008, 334458, 2959, 2041, 15340, 108468, 300979, 11680, 24519, 9626, 382210, 1038, 56604, 1618, 131154, 373359, 15043, 123800, 1950, 8531, 306118, 24485, 7505, 47925, 27861, 250145, 11990, 4286, 390611, 399832, 274273, 127350, 173293, 14371, 40180, 67039, 4160, 5367, 125356, 7487, 527650, 21937, 21625, 79238, 14431, 1205, 137559, 1625, 19213, 715034, 50027, 39248, 7698, 25480, 1657, 42086, 84254, 16894, 53807, 141284, 5908, 1312, 108907, 5635, 4187, 65677, 15691, 42956, 186470, 273906, 78413, 63277, 16063, 2291997, 129645, 338212, 60517, 165607, 147021, 37735, 947, 41649, 38277, 145322, 36184, 155851, 164787, 57241, 114810, 61166, 57731, 90451, 1847, 15330, 10333, 14781, 138584, 77713, 51554, 229069, 1497, 205413, 22491, 70347, 12640, 12649, 133969, 13346, 258378, 713733, 244658, 396553, 131981, 65854, 106041, 29858, 31285, 315198, 20581, 28422, 126706, 498296, 47011, 203279, 92815, 76762, 34853, 103348, 204628, 697618, 20008, 4573, 62465, 27044, 15657, 95818, 54569, 114613, 1064, 6740, 57168, 8899, 616075, 526435, 122084, 16439, 240898, 14854, 117712, 5822, 457544, 51502, 165281, 1717, 80257, 278208, 93376, 9316, 26170, 26987, 48345, 7100, 8790, 21968, 136986, 581940, 32174, 36059, 237674, 70141, 33115, 20774, 30237, 18246, 217485, 23631, 20822, 29110, 46109, 756, 528448, 44925, 33628, 125575, 79229, 1193, 118734, 1784, 316434, 0, 30806, 346287, 143938, 78975, 19671, 1607, 145677, 5683, 9954, 140248, 63792, 38609, 761299, 52936, 144861, 1197, 30072, 389012, 3192, 13605, 176657, 24337, 64758, 15989, 7480, 35935, 169235, 387462, 13548, 32629, 173694, 181844, 139392, 11745, 36643, 452091, 9736, 50823, 167214, 26660, 26388, 166892, 45058, 59764, 70562, 1506, 25927, 8551, 152881, 121728, 1316, 17754, 22270, 26095, 24012, 33756, 17195, 272140, 19795, 16038, 49924, 4990, 35723, 158659, 5232, 47598, 45702, 35051, 336811, 259841, 437885, 209575, 8153, 95006, 136422, 23547, 206927, 7920, 112695, 20229, 97105, 535952, 101286, 8759, 28408, 41311, 49174, 18880, 15482, 9818, 326878, 44188, 215101, 2947, 4379, 90208, 13116, 41589, 130719, 78371, 41429, 54204, 157664, 19529, 27698, 18457, 93380, 148257, 45775, 65134, 34291, 1299, 15006, 1925, 11841, 5070, 195259, 101181, 48180, 1880, 3417, 4700, 2390, 105174, 9101, 143752, 305077, 7979, 1062, 43366, 179312, 21232, 15829, 576651, 6713, 1338, 301480, 2572, 6980, 21409, 6848, 513991, 152042, 43289, 98206, 134929, 51214, 10692, 435353, 5528, 2272, 644688, 139514, 94419, 14848, 107218, 70065, 28785, 19061, 149077, 319855, 62426, 260787, 29603, 197205, 79677, 3132, 20241, 165333, 6308, 2734, 249403, 1878, 1452, 14401, 36908, 221042, 2708, 172215, 12315, 64860, 1280740, 21258, 8279, 1264, 13793, 203911, 27562, 2492, 178645, 4604, 108442, 20262, 16889, 23423, 80420, 14330, 23990, 243646, 1270, 16026, 4358, 212004, 4545, 1407, 1180, 194512, 33582, 255844, 143532, 5137, 87095, 335236, 27543, 5389, 301984, 10979, 443686, 952, 2699, 351123, 23903, 290325, 13175, 36171, 122325, 224052, 18175, 11918, 306038, 213319, 400604, 44743, 10113, 509399, 96049, 37759, 66084, 13948, 103090, 57982, 79773, 7053, 66605, 49081, 58275, 12488, 171191, 139934, 844, 2748, 50580, 11841, 1657, 212556, 1637, 231188, 3972, 29289, 224225, 10128, 11550, 126518, 815853, 4652, 4531, 70304, 29888, 4746, 129753, 6578, 214216, 84206, 242596, 57379, 272474, 2143, 14851, 2556, 3049, 49153, 2048, 70572, 13915, 310481, 23254, 31768, 82257, 282160, 101625, 14388, 26579, 73768, 199946, 176448, 6159, 52530, 2345, 2637, 427336, 23491, 47397, 229349, 20799, 17371, 9299, 40983, 7660, 1349, 326244, 335664, 17874, 13415, 64573, 7759, 35506, 152685, 54424, 24705, 31993, 84229, 5760, 265592, 5056, 7330, 48673, 21471, 26089, 21815, 13073, 14205, 200867, 107997, 24996, 1084519, 2620, 44108, 11809, 275319, 26705, 6172, 56975, 13320, 3104, 99826, 79473, 113304, 1941, 2816, 422500, 6412, 221582, 50518, 222377, 10398, 161477, 1921, 4050, 34318, 28963, 68946, 7453, 93458, 12829, 711869, 86389, 1585, 75583, 244837, 53664, 34227, 22997, 54163, 89556, 28269, 113189, 64399, 27321, 43063, 80394, 163653, 59852, 205621},
  
  };
  
  for (bool simple_graphs : {true, false}) {
    cout << "Randomized stress test" << endl;
    Random random(123);
    const int repeat = 1;
    clock_t c = 0;
    for (int trial = 0; trial < trials; ++trial) {
      int M = 1 + int(1000 * random.RandExp());
      int N = std::max(int(1.5 + sqrt(2.0 * M)),
                             int(M / (1 + 3 * random.RandExp())));
      UndirectedGraph g = LargestComponent(ErdosRenyi(N, M, simple_graphs, &random));
      CHECK_GE(g.NumNodes(), int(N * 0.6));
      N = g.NumNodes();
      M = g.NumEdges();
      vector<Edge> edges;
      edges.reserve(M);
      for (int a = 0; a < N; ++a) {
        for (int b : g.Neighbors(a)) if (b >= a) {
          edges.push_back({a, b, random.Uniform(1000)});
          if (random.Uniform(2)) {
            std::swap(edges.back().node1, edges.back().node2);
          }
        }
      }
      shuffle(edges.begin(), edges.end(), random);
      c -= clock();
      for (int i = 0; i < repeat; ++i) {
        //cout << Prim(N, edges) << ", ";
        CHECK_EQ(Prim(N, edges), expected[simple_graphs ? 0 : 1][trial]);
      }
      c += clock();
    }
    double t = double(c) / CLOCKS_PER_SEC;
    cout << "Time: " << t << "s" << endl;
    cout << "PASSED at line " << __LINE__ << endl;
  }
}
